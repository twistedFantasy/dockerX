groups:
- name: cpu
  rules:
    - alert: high_host_cpu_utilisation
      expr: 100 - (avg by(instance) (irate(node_cpu{mode="idle"}[5m])) * 100) > 80
      for: 20m
      labels:
        severity: warning
      annotations:
        description: 'High CPU utilisation detected for instance {{ $labels.instance_id
          }} tagged as: {{ $labels.instance_name_tag }}, the utilisation is currently:
          {{ $value }}%'
        summary: CPU Utilisation Alert
